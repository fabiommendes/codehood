$schema: "https://json-schema.org/draft/2020-12/schema"
$id: "code-io"

title: Coding IO question
description: >-
  A programming question that evaluates the result using by passing specific text inputs and 
  comparing it with the expected outputs displayed on the terminal.
# type: object
# additionalProperties: false
allOf:
  - $ref: "base-programming-question"
  - type: object
    properties:
      type:
        const: code-io

      conf:
        $ref: "#/$defs/code-io-conf"

      answer-key:
        description: >
          An array of mechanisms to produce input and output examples.
        type: array
        minItems: 1
        items:
          anyOf:
            - $ref: "#/$defs/io-answer-key"
            - $ref: "#/$defs/iospec-answer-key"

$defs:
  code-io-conf:
    description: >-
      A dictionary with configuration options for how the student submissions will be matched
      with the answer key.
    type: object
    properties:
      match-spaces:
        description: >-
          Whether to normalize when comparing the output with the expected output. If true,
          it ignores trailing whitespaces at each line and tries to find a tab size that
          would match sequences of spaces to sequences of tabs.
        type: boolean
        default: false

      case-sensitive:
        description: >-
          If true (default), ignore case when matching strings.
        type: boolean
        default: true

      ignore-accents:
        description: >-
          If true, normalize unicode strings to remove accents and diacritics.
        type: boolean
        default: false

  io-answer-key:
    type: object
    required: [input]
    properties:
      input:
        description: The input string be passed to the program.
        type: string
      output:
        description: The expected output for this execution.
        type: string

  iospec-answer-key:
    type: object
    required: [iospec]
    properties:
      iospec:
        description: An iospec source code describing the program interaction.
        type: string
